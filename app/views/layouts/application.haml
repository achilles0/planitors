!!!
%html
  %head
    -# Generated by https://realfavicongenerator.net:
    -# <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    -# <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    -# <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    -# <link rel="manifest" href="/manifest.json">
    -# <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    -# <meta name="theme-color" content="#ffffff">
    -# My translation to RoR haml:
    = favicon_link_tag '/apple-touch-icon.png', rel: 'apple-touch-icon', type: 'image/png'
    = favicon_link_tag '/favicon-32x32.png', rel: 'icon', type: 'image/png'
    = favicon_link_tag '/favicon-16x16.png', rel: 'icon', type: 'image/png'

    %title All For Eco
    = csrf_meta_tags
    = stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload'
    = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'
  %body{ class: [controller_name, "level-#{chosen_level.id}"] }
    #menu-bar
      - if current_user
      - streak = current_user.streak?
        %span.user All For Eco &mdash; #{current_user.name ? current_user.name : current_user.email} &mdash; Score #{current_user.post_score ? current_user.post_score + streak['total'] : 0} (#{current_user.post_score ? current_user.post_score : 0} + #{streak['total']}) &mdash; Streak #{streak["month"]}/#{streak["week"]}/#{streak["day"]}
      %br
      = link_to messages_url, class: ('active' if current_page?(messages_url)) do
        %span.icon= Emoji.find_by_alias('postal_horn').raw
        %span Messages

      = link_to newsitems_url, class: ('active' if current_page?(newsitems_url)) do
        %span.icon= Emoji.find_by_alias('eyes').raw
        %span News

      = link_to missions_url, class: ('active' if current_page?(missions_url)) do
        %span.icon= Emoji.find_by_alias('rocket').raw
        %span Missions

      = link_to accepted_missions_url, class: ('active' if current_page?(accepted_missions_url)) do
        %span.icon= Emoji.find_by_alias('star').raw
        %span Accepted missions

      = link_to highscore_url, class: ('active' if current_page?(highscore_url)) do
        %span.icon= Emoji.find_by_alias('star2').raw
        %span Highscore

      -# link_to levels_url, class: ('active' if current_page?(levels_url)) do
        %span.icon= Emoji.find_by_alias('video_game').raw
        %span Levels

      = link_to roadmap_url, class: ('active' if current_page?(roadmap_url)) do
        %span.icon= Emoji.find_by_alias('video_game').raw
        %span Levels

      - if current_user
        = link_to user_prefs_interests_url do
          %span.icon= Emoji.find_by_alias('ballot_box_with_check').raw
          %span Interests

      - if current_user
        = link_to destroy_user_session_url, method: :delete do
          %span.icon= Emoji.find_by_alias('door').raw
          %span Sign out

    %p.notice= notice
    %p.alert= alert
    = yield
    - if false && current_user && controller_name['missions'] # FIXME: Disabled for now
      #carbon-budget
        .level-progress
          Level progress:
          = "#{current_user.progress(lvl: chosen_level, percentage: true)}%"
          .meter
            %span{ style: "width: #{current_user.progress(lvl: chosen_level, percentage: true)}%" }
          Daily CO2 budget:
          = current_user.co2_result
          kg / day above budget
          .meter
            %span{ style: "width: #{current_user.co2_budget(percentage: true)}%" }
            %span.orange.second{ style: "left: #{current_user.co2_budget(percentage: true) + 0.5}%; width: #{current_user.co2_result(percentage: true)}%" }
          .budget-numbers
            = current_user.co2_result
            .budget-numbers-explanation
              ton CO2
              above budget
          = image_tag current_user.image
          = current_user.name
          = link_to Emoji.find_by_alias('door').raw + ' Sign out', destroy_user_session_url, method: :delete
      #budget-spacer